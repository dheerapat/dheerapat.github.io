<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Modular Monolithic - Dheeto Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Not all microservices are good, not all monolithics are bad." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Modular Monolithic" />
<meta property="og:description" content="Not all microservices are good, not all monolithics are bad." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dheerapat.github.io/posts/modular-monolithic/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-07-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-07-19T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Modular Monolithic"/>
<meta name="twitter:description" content="Not all microservices are good, not all monolithics are bad."/>
<script src="https://dheerapat.github.iojs/feather.min.js"></script>
	
	
        <link href="https://dheerapat.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://dheerapat.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://dheerapat.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css"  disabled />
	

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://dheerapat.github.io">Dheeto Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="https://dheerapat.github.iojs/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Modular Monolithic</h1>
			<div class="meta">Posted on Jul 19, 2024</div>
		</div>
		

		<section class="body">
			<h3 id="the-ugly-duck">The Ugly Duck</h3>
<p>When we talk about the word <em>monolithic</em>, many engineers have negative feelings about it. Some might say, &ldquo;Expanding a monolithic application is very hard,&rdquo; or &ldquo;Maintaining a monolithic app is an exhausting task.&rdquo; Often, we assume these claims are true simply because they relate to monolithic design. We frequently hear negative comments about monolithic architecture and praise another architecture, <em>microservices</em>, as if it&rsquo;s the ultimate solution.</p>
<p>But what if I told you there are multiple ways to build a monolithic application, and if done correctly, it is much easier for a small team to maintain and expand these apps?</p>
<h3 id="im-not-recommend-this">I&rsquo;m not Recommend This</h3>
<p>The most simplest application that can be shipped very fast if you don&rsquo;t care anything will probably look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dbConnector</span>(<span style="color:#e6db74">&#39;connectionString&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// do some thing
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;something&#39;</span>)
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#39;/user&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// do some thing with user
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">save</span>(<span style="color:#e6db74">&#39;something&#39;</span>)
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#39;/product&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// do some thing with product
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">save</span>(<span style="color:#e6db74">&#39;something&#39;</span>)
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`app listening on port </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>I just litterally pull this snippet from &lsquo;hello world&rsquo; part of <a href="https://expressjs.com/">express</a> documentation and  you can see that all of our interest is sit right here in a single file. I think all of us are agree that this is just bad for real world production system and only work for quick prototyping thing only, it&rsquo;s bad for scaling, it&rsquo;s bad for maintaining, and it&rsquo;s bad for developer experience, so let move on to the next example.</p>
<p>So the next step up that most of my readers might come across regulary might look something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>project/
</span></span><span style="display:flex;"><span>│
</span></span><span style="display:flex;"><span>├── controllers/
</span></span><span style="display:flex;"><span>│   ├── userController.js
</span></span><span style="display:flex;"><span>│   └── productController.js
</span></span><span style="display:flex;"><span>│
</span></span><span style="display:flex;"><span>├── models/
</span></span><span style="display:flex;"><span>│   ├── userModel.js
</span></span><span style="display:flex;"><span>│   └── productModel.js
</span></span><span style="display:flex;"><span>│
</span></span><span style="display:flex;"><span>├── routes/
</span></span><span style="display:flex;"><span>│   ├── userRoutes.js
</span></span><span style="display:flex;"><span>│   └── productRoutes.js
</span></span><span style="display:flex;"><span>│
</span></span><span style="display:flex;"><span>├── app.js
</span></span><span style="display:flex;"><span>└── server.js
</span></span></code></pre></div><p>Well, isn&rsquo;t that more modular? Actually this is probably the most common file structure for most of the monolithic application out there. We would probably seen one before and you know what? It actually working fine! For small project or very little app that design to only do one handful of job and not shift a lot of focus this is pretty maintainable, but what is the catch?</p>
<p>Now imagine that this app is expanding, focusing more on other topics, with more models, controllers, and services added. You might argue, &ldquo;Why can&rsquo;t we add more? We already separate our concerns for each topic into its own module, and it will work just fine.&rdquo;</p>
<p>Well, if humans only did what they said, you would probably get away with this. But imagine what will happen when you work on a user controller and need to access product information. What will prevent your subconscious mind from importing the product module into a user controller? Overtime this <em>&lsquo;domain spilled&rsquo;</em> will result in strongly coupled codebases. Even with strict code review process, this kind of tangling will slip into a large pull request eventually.</p>
<h3 id="properly-modularize-monolithic">Properly Modularize Monolithic</h3>
<p>What I encourage you is to do some thing like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>project/
</span></span><span style="display:flex;"><span>│
</span></span><span style="display:flex;"><span>├── domains/
</span></span><span style="display:flex;"><span>│   ├── customer/
</span></span><span style="display:flex;"><span>│   │   ├── entity/
</span></span><span style="display:flex;"><span>│   │   ├── value-obj/
</span></span><span style="display:flex;"><span>│   │   ├── aggregate/
</span></span><span style="display:flex;"><span>│   │   │   ├── customerAggregate.js
</span></span><span style="display:flex;"><span>│   │   ├── repository/
</span></span><span style="display:flex;"><span>│   │   │   ├── customerRepository.js
</span></span><span style="display:flex;"><span>│   │   └── use-cases/
</span></span><span style="display:flex;"><span>│   │   │   ├── command/
</span></span><span style="display:flex;"><span>│   │   │   └── query/
</span></span><span style="display:flex;"><span>│   └── product/
</span></span><span style="display:flex;"><span>│       ├── ...
</span></span><span style="display:flex;"><span>│
</span></span><span style="display:flex;"><span>├── app.js
</span></span><span style="display:flex;"><span>└── server.js
</span></span></code></pre></div><p>Whoa! Hold on, what are those words that just popped up? Domain, entity, value-object, aggregate. These words are terminology mostly used in domain-driven design (DDD). It&rsquo;s a design philosophy to help software engineers deliver software that closely resembles the business side. But let&rsquo;s talk about that some other time.</p>
<p>What I&rsquo;d like to point out is that you should modularize your app by domain. If done right, this is much easier to work with. You can assign different teams to develop entire domains, and other teams to develop other domains. Changes in one domain won&rsquo;t affect the other (if you follow DDD philosophy, it should minimally or not affect each other at all). You can have peace of mind when deploying something new or fixing old issues, knowing it won&rsquo;t break the whole app. Because we separate our concern at a <em>&lsquo;domain&rsquo;</em> level, changing something at this level will change the entire domain. Like our previous example, if you want to cooperate product information with the user. It will be done in the domain level, and it must pass the tests you build for the whole domain. So, you can focus on one domain at a time, which is very suitable for a small team that cannot handle different microservices all at once. I will write a more in-depth article about this in the future with more examples to elaborate more on this kind of architecture.</p>
<h3 id="balance-is-everything">Balance is Everything</h3>
<p>I&rsquo;m not saying you should follow my words right now and change the whole structure of your app according to some guy on the internet. In fact, gradually shifting to this kind of architecture is what I do every day. Our team did not come up with the perfect setup from the beginning and had to trial and error to reflect business needs before we could focus on how beautiful our codebases are. Because in the end, you build software to solve your problems. So, let&rsquo;s make sure it solves the problem first.</p>

		</section>

		<div class="post-tags">
			
			
			
		</div>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        var disqus_shortname = 'dheeto-blog';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2024  © dheeto |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


</div>
    </body>
</html>
